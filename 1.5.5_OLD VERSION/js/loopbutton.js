function injectScript(t,e){var o=document.getElementsByTagName(e)[0];var u=document.createElement("script");var n=document.createElement("script");u.setAttribute("type","text/javascript");n.setAttribute("type","text/javascript");u.append(`Autotube = ${t}()`);o.appendChild(u);n.append("autotube = Autotube = new Autotube();");o.appendChild(n);u.remove()}let Autotube=function t(e){const o=window.MutationObserver||window.WebKitMutationObserver;const u={loadedAt:Date.now(),_autoLoop:null,_reloadDurationCheck:120*60*1e3,_debug:false,getIsAutoLoop:function(){return u._autoLoop},getReloadDurationCheck:function(){return localStorage.reloadDurationCheck?JSON.parse(localStorage.reloadDurationCheck):u._reloadDurationCheck},getDebug:function(){return u._debug},setAutoLoop:function(t){return u._autoLoop=t},setReloadDurationCheck:function(t){return parseInt(t)>=0?u._reloadDurationCheck=t:u._reloadDurationCheck},setDebug:function(t){return typeof t==="boolean"?u._debug=t:u._debug}};const n={player:()=>document.getElementById("movie_player"),loop:{button:()=>a()[1],status:function(){return n.loop.button()?JSON.parse(n.loop.button().getAttribute("aria-pressed")):undefined}}};function a(){return[...document.getElementsByClassName("header ytd-playlist-panel-renderer")[0].getElementsByClassName("style-scope yt-icon-button")].filter(t=>t.id=="button")};const i=()=>{if(n.player().getCurrentTime()<=0){u.loadedAt<=Date.now()-u.getReloadDurationCheck()&&l()}};const l=()=>window.location.reload();const s=()=>!!document.fullscreenElement;function f(){const t={getButton:window.document.getElementsByClassName("ytp-play-button ytp-button")[0]||window.document.getElementById("play-pause-button"),config:{attributes:true,childList:true,subtree:true},callback:(t,e)=>{if(t.some(t=>t.type==="attributes")){if(t){c(t);if(u.getDebug()==true)console.log("click")}else{r();i();if(u.getDebug()==true)console.log("no click")}}}};const e={setInterval:setInterval(()=>{if(window.location.href.indexOf("/watch")==-1)return;try{const u=new o(t.callback);u.observe(t.getButton,t.config);e.setLoop();clearInterval(e.setInterval)}catch(t){window.location.reload();u.getDebug()&&console.log(t)}},1e3),setLoop:function(){if(n.loop.button()&&u.getIsAutoLoop()&&!n.loop.status()){n.loop.button().click()}}};setInterval(()=>{yt.util&&yt.util.activity&&yt.util.activity.setTimestamp();e.setLoop()},5e3);return u}function p(){return u.loadedAt}function g(){return u.getIsAutoLoop()}function b(){return u.getReloadDurationCheck()}function m(t){return u.setReloadDurationCheck(t)}function y(t){return u.setDebug(t)}function S(){return n}function t(){this.loadedAt=p;this.isAutoLoop=g;this.getReloadDurationCheck=b;this.setReloadDuration=t=>m(t);this.setDebug=t=>y(t);this.get_yt=S;f()}const k=(t,e)=>{switch(t){case"autoLoop":u.setAutoLoop(e);if(e!==n.loop.status())n.loop.button()&&n.loop.button().click();break}};addEventListener("message",(function(t){for(key in t.data){k(key,t.data[key])}}));return t};window.onload=t=>{chrome.runtime.onMessage.addListener(t=>{postMessage(t,"*")});chrome.storage.sync.get(null,(function(t){t={autoLoop:t.autoLoop===undefined||t.autoLoop===null?true:JSON.parse(t.autoLoop)};postMessage(t,"*");injectScript(Autotube,"html")}))};injectScript(Autotube,"html");